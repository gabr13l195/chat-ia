<div class="input-container">
  <!-- Image Preview -->
  <div class="image-preview" *ngIf="imagePreview">
    <div class="preview-container">
      <img [src]="imagePreview" alt="Vista previa" class="preview-image" />
      <button class="remove-image" (click)="removeImage()" type="button">
        <span>×</span>
      </button>
    </div>
  </div>

  <!-- Audio Preview -->
  <div class="audio-preview" *ngIf="audioPreview">
    <div class="preview-container">
      <audio [src]="audioPreview" controls class="preview-audio"></audio>
      <button class="remove-audio" (click)="removeAudio()" type="button">
        <span>×</span>
      </button>
    </div>
  </div>

  <!-- Input Area -->
  <div class="input-area" 
       [ngClass]="{'dragging': isDragging}"
       (dragover)="onDragOver($event)"
       (dragleave)="onDragLeave($event)"
       (drop)="onDrop($event)">
    
    <div class="input-wrapper">
      <textarea
        [(ngModel)]="messageText"
        (keypress)="onKeyPress($event)"
        placeholder="Escribe tu mensaje aquí..."
        class="message-input"
        rows="1"
        #messageTextarea>
      </textarea>
      
      <div class="input-actions">
        <!-- Botón de imagen -->
        <label class="file-input-label" for="image-upload">
          <span class="upload-icon">📷</span>
          <input
            id="image-upload"
            type="file"
            accept="image/*"
            (change)="onFileSelected($event, 'image')"
            class="file-input"
            hidden>
        </label>
        
        <!-- Botón de audio -->
        <label class="file-input-label" for="audio-upload">
          <span class="upload-icon">🎵</span>
          <input
            id="audio-upload"
            type="file"
            accept="audio/*"
            (change)="onFileSelected($event, 'audio')"
            class="file-input"
            hidden>
        </label>
        
        <!-- Botón de grabación -->
        <button 
          type="button"
          class="record-button"
          [ngClass]="{'recording': isRecording}"
          (click)="isRecording ? stopRecording() : startRecording()">
          <span class="record-icon">{{ isRecording ? '⏹️' : '🎤' }}</span>
        </button>
        
        <button 
          type="button"
          class="send-button"
          [disabled]="!messageText.trim() && !selectedImage && !selectedAudio"
          (click)="onSendMessage()">
          <span class="send-icon">➤</span>
        </button>
      </div>
    </div>
    
    <!-- Drag & Drop Hint -->
    <div class="drag-hint" *ngIf="isDragging">
      <span>¡Suelta la imagen o audio aquí!</span>
    </div>
  </div>
  
  <!-- Help Text -->
  <div class="help-text">
    <span>💡 Puedes arrastrar y soltar imágenes/audio aquí, grabar audio con el micrófono, o usar los botones de archivo</span>
  </div>
</div>
